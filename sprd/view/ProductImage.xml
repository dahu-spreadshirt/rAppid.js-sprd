<view:Image xmlns="http://www.w3.org/1999/xhtml"
            xmlns:ui="js.ui" xmlns:js="js.core" xmlns:view="">

    <js:Script>

        <![CDATA[
        (function () {

            var PRODUCT = "product",
                    COMPOSITION = "composition";

            return {

                defaults: {
                    // if null use default view
                    view: null,
                    type: PRODUCT
                },

                imageUrl: function () {
                    var url = "";

                    if (this.$.product) {
                        var product = this.$.product;

                        if (type != COMPOSITION) {
                            // use product
                            url = "http://image.spreadshirt.net/image-server/image/product/" + product.$.id;
                        } else {
                            url = "http://image.spreadshirt.net/image-server/image/composition/" + product.$.id;
                        }

                        if (this.$.width) {
                            url += "/width/" + this.normalizeSize(this.$.width);
                        }

                        if (this.$.height) {
                            url += "/height/" + this.normalizeSize(this.$.height);
                        }
                    }

                    return url;

                }.onChange('product', 'width', 'height', 'type')

            }
        })
        ]]>

    </js:Script>
</view:Image>